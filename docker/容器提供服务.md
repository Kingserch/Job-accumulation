+ ### Docker命令
    + [为centos镜像添加SSH服务](#为镜像添加SSH服务)
    + [web服务apache,nginx,tomcat,lamp](#web服务)
    + [搜寻镜像search](#搜寻镜像)
    + [创建镜像commit,import,build](#创建镜像)
    + [存出和载入镜像save,load](#存出和载入镜像)
    + [上传镜像push](#上传镜像)	
+ ### 为镜像添加SSH服务
```
[root@42-m ~]# docker run -it centos:latest /bin/bash	#基于centos镜像创建centos镜像并运行
[root@db30624f62ff /]# yum update -y
[root@db30624f62ff /]# yum -y install passwd openssl openssh-server  openssh-clients #进入容器后，升级并安装ssh服务端和客户端，服务端能让其他主机远程登录本机，客户端能让本机远程登录其他主机
[root@db30624f62ff /]#  sed -i "s/UsePAM.*/UsePAM no/g" /etc/ssh/sshd_config	#取消PAM登录限制
[root@db30624f62ff ssh]# ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key	#ssh-keygen命令创建公私秘钥-t指定名字-f指定路径
Generating public/private rsa key pair.
Enter passphrase (empty for no passphrase): 	#输入密码，回车为空
Enter same passphrase again: 		#再次输入，回车为空
Your identification has been saved in /etc/ssh/ssh_host_rsa_key.	#私钥
Your public key has been saved in /etc/ssh/ssh_host_rsa_key.pub.	#公钥
The key fingerprint is:
SHA256:5zz5RNatGNEqy//jQl1R2bhMDSjgGLNaK8Wxzklr0y8 root@db30624f62ff
The key's randomart image is:
+---[RSA 2048]----+
|      + ..   ..+=|
|     . O  . ..ooo|
|      O .  ..o...|
|     B =     +o..|
|    o O S o =....|
|     o . * *.o.. |
|        E O.o .  |
|         . =. .  |
|            o+o. |
+----[SHA256]-----+
[root@db30624f62ff ssh]# /usr/sbin/sshd -D &
[root@db30624f62ff ssh]# WARNING: 'UsePAM no' is not supported in Fedora and may cause several problems.	#因为取消了PAM登录限制所以报这个错误
Could not load host key: /etc/ssh/ssh_host_ecdsa_key
Could not load host key: /etc/ssh/ssh_host_ed25519_key
[root@db30624f62ff ssh]# ssh-keygen -t ecdsa -f /etc/ssh/ssh_host_ecdsa_key		#我们来添加这俩文件
[root@db30624f62ff ssh]# ssh-keygen -t ed25519 -f /etc/ssh/ssh_host_ed25519_key	
[root@db30624f62ff ssh]# ls
moduli	    ssh_config.d	ssh_host_ecdsa_key.pub	ssh_host_ed25519_key.pub  ssh_host_rsa_key.pub
ssh_config  ssh_host_ecdsa_key	ssh_host_ed25519_key	ssh_host_rsa_key	  sshd_config
[root@db30624f62ff ssh]# /usr/sbin/sshd -D &
[2] 238
[root@db30624f62ff ssh]# ps -ef | grep sshd	#可以看到sshd服务已经启动
root        234      1  0 05:55 pts/0    00:00:00 /usr/sbin/sshd -D
root        240      1  0 06:11 pts/0    00:00:00 grep --color=auto sshd
[root@db30624f62ff ssh]# passwd root	#修改root密码
Changing password for user root.
New password: 
BAD PASSWORD: The password is shorter than 8 characters
Retype new password: 
passwd: all authentication tokens updated successfully.
[root@db30624f62ff ssh]# ssh localhost	#测试
root@localhost's password: 
[root@db30624f62ff ~]#	#~标识符更改测试成功
[root@db30624f62ff ~]# vim /etc/hosts 	#末尾添加容器的ip跟容器的唯一ID 为了让宿主机可以通过ssh方式访问容器
127.0.0.1       localhost
::1     localhost ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
172.17.0.2      db30624f62ff
[root@db30624f62ff ~]# mkdir /root/.ssh/authorized_keys 
[root@db30624f62ff ssh]# cat ssh_host_rsa_key.pub >>/root/.ssh/authorized_keys	#把用ssh-keygen 创建的公钥放在authorized_keys文件中
[root@42-m ssh]# ssh root@172.17.0.2	#宿主机登录容器测试
root@172.17.0.2's password: 
Last login: Mon Dec 30 06:25:36 2019 from 172.17.0.1
[root@db30624f62ff ~]# 
```
+ ### web服务
1.apache服务
```
[root@42-m ~]# mkdir -p apache_centos/sample
[root@42-m ~]# cd apache_centos/
[root@42-m apache_centos]# touch Dockerfile run.sh
[root@42-m apache_centos]# vim Dockerfile	#Dockerfile内容如下
#新生成的镜像是基于sshd:dockerfile镜像
FROM sshd:dockerfile
MAINTAINER by Steven
#安装wget
RUN yum install -y wget
#安装httpd
RUN yum install -y httpd
#修改apache配置文件
RUN sed -i 's/#ServerName www.example.com:80/ServerName localhost:80/g' /etc/httpd/conf/httpd.conf
#启动apache服务
RUN /usr/sbin/httpd
#复制服务启动脚本并设置权限
ADD run.sh /usr/local/sbin/run.sh
RUN chmod 755 /usr/local/sbin/run.sh
#把宿主机上的sampl目录下的index.html文件copy到容器web目录下
COPY sample/index.html /var/www/html/index.html
#开放80端口
EXPOSE 80
CMD ["/usr/local/sbin/run.sh"]
[root@42-m apache_centos]# vim run.sh	#脚本如下
#!/bin/bash
/usr/sbin/sshd &
/usr/sbin/httpd -D FOREGROUND
[root@42-m apache_centos]# docker build -t apache_dockerfile:centos . #生成新的镜像
[root@42-m apache_centos]#  docker run -d -p 33:22 -p 88:80 apache_dockerfile:centos /usr/local/sbin/run.sh	#把容器的端口映射并运行
```
	